<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eToro Copy Trader Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/recharts@2.5.0/dist/Recharts.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBVE6eRSapt2fwVnLoQm2EfcScksg0OWiU",
            authDomain: "etoro-tracker.firebaseapp.com",
            projectId: "etoro-tracker",
            storageBucket: "etoro-tracker.firebasestorage.app",
            messagingSenderId: "941552714377",
            appId: "1:941552714377:web:8c44519dc1352aea7bbc58"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.firebaseDb = db;
        window.firebaseUtils = { collection, addDoc, onSnapshot, query, orderBy };
        window.SECURITY_KEY = "my-secret-etoro-key-2024";
        window.firebaseReady = true;
    </script>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;
        const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } = Recharts;

        function FilterControl({ column, label, type, filters, updateFilter }) {
            const filter = filters[column] || { enabled: false, type, min: '', max: '', value: '' };
            return (
                <div className="bg-slate-700 rounded-lg p-3">
                    <div className="flex items-center gap-2 mb-2">
                        <input type="checkbox" checked={filter.enabled}
                            onChange={(e) => updateFilter(column, { ...filter, enabled: e.target.checked })}
                            className="w-4 h-4" />
                        <label className="text-sm font-semibold">{label}</label>
                    </div>
                    {type === 'range' && (
                        <div className="flex gap-2">
                            <input type="number" placeholder="Min" value={filter.min || ''}
                                onChange={(e) => updateFilter(column, { ...filter, min: e.target.value, type: 'range', enabled: true })}
                                className="w-full bg-slate-600 border border-slate-500 rounded px-2 py-1 text-sm" />
                            <input type="number" placeholder="Max" value={filter.max || ''}
                                onChange={(e) => updateFilter(column, { ...filter, max: e.target.value, type: 'range', enabled: true })}
                                className="w-full bg-slate-600 border border-slate-500 rounded px-2 py-1 text-sm" />
                        </div>
                    )}
                    {type === 'text' && (
                        <input type="text" placeholder={`Search...`} value={filter.value || ''}
                            onChange={(e) => updateFilter(column, { ...filter, value: e.target.value, type: 'text', enabled: true })}
                            className="w-full bg-slate-600 border border-slate-500 rounded px-2 py-1 text-sm" />
                    )}
                </div>
            );
        }

        function SortableHeader({ column, label, sortColumn, sortDirection, handleSort, align = 'left' }) {
            return (
                <th className={`text-${align} py-3 px-2 font-semibold cursor-pointer hover:bg-slate-700`}
                    onClick={() => handleSort(column)}>
                    <div className={`flex items-center gap-1 ${align === 'right' ? 'justify-end' : ''}`}>
                        {label}
                        {sortColumn === column && <span className="text-blue-400">{sortDirection === 'asc' ? '▲' : '▼'}</span>}
                    </div>
                </th>
            );
        }

        function EtoroTracker() {
            const [activeTab, setActiveTab] = useState('dashboard');
            const [accountFilter, setAccountFilter] = useState('All');
            const [showAddData, setShowAddData] = useState(false);
            const [transactions, setTransactions] = useState([]);
            const [snapshots, setSnapshots] = useState([]);
            const [sortColumn, setSortColumn] = useState('trader');
            const [sortDirection, setSortDirection] = useState('asc');
            const [showFilters, setShowFilters] = useState(false);
            const [filters, setFilters] = useState({});
            const [savedFilters, setSavedFilters] = useState([]);
            const [filterName, setFilterName] = useState('');
            const [selectedTraders, setSelectedTraders] = useState([]);
            const [chartType, setChartType] = useState('equity');
            const [newData, setNewData] = useState({
                dataType: 'snapshot',
                date: new Date().toISOString().split('T')[0].replace(/-/g, '.'),
                trader: '', account: 'Virtual', equity: '', amount: '', transactionType: 'DEPOSIT', note: ''
            });

            useEffect(() => {
                const initFirebase = async () => {
                    if (!window.firebaseReady) {
                        setTimeout(initFirebase, 100);
                        return;
                    }
                    const { collection, onSnapshot, query, orderBy } = window.firebaseUtils;
                    const db = window.firebaseDb;
                    onSnapshot(query(collection(db, 'transactions'), orderBy('date', 'desc')), (snapshot) => {
                        setTransactions(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                    });
                    onSnapshot(query(collection(db, 'snapshots'), orderBy('date', 'desc')), (snapshot) => {
                        setSnapshots(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                    });
                };
                initFirebase();
            }, []);

            const parseDate = (dateStr) => {
                if (!dateStr) return null;
                const parts = dateStr.split('.');
                if (parts.length === 3) return new Date(parts[0], parts[1] - 1, parts[2]);
                return new Date(dateStr);
            };

            const daysBetween = (d1, d2) => {
                const date1 = parseDate(d1), date2 = parseDate(d2);
                return date1 && date2 ? Math.floor((date1 - date2) / (1000 * 60 * 60 * 24)) : 0;
            };

            const weightedAverage = (snaps, days = 14) => {
                if (!snaps.length) return 0;
                const sorted = [...snaps].sort((a, b) => parseDate(b.date) - parseDate(a.date));
                const cutoff = new Date(Date.now() - days * 24 * 60 * 60 * 1000);
                const recent = sorted.filter(s => parseDate(s.date) >= cutoff && s.plPerDay !== 0);
                if (!recent.length) return 0;
                let sum = 0, totalW = 0;
                for (let i = 0; i < Math.min(recent.length, days); i++) {
                    const w = Math.exp(-i / 5);
                    sum += recent[i].plPerDay * w;
                    totalW += w;
                }
                return totalW > 0 ? sum / totalW : 0;
            };

            const snapshotsWithCalcs = useMemo(() => {
                const sorted = [...snapshots].sort((a, b) => `${b.trader}-${b.account}-${b.date}`.localeCompare(`${a.trader}-${a.account}-${a.date}`));
                const byKey = {};
                sorted.forEach(s => {
                    const k = `${s.trader}-${s.account}`;
                    if (!byKey[k]) byKey[k] = [];
                    byKey[k].push(s);
                });
                Object.values(byKey).forEach(snaps => {
                    snaps.sort((a, b) => parseDate(a.date) - parseDate(b.date));
                    let maxEq = 0;
                    snaps.forEach(s => {
                        maxEq = Math.max(maxEq, s.equity);
                        s.runningMaxEquity = maxEq;
                        s.currentDrawdown = maxEq > 0 ? ((maxEq - s.equity) / maxEq) * 100 : 0;
                    });
                });
                return sorted.map((snap, i) => {
                    const prev = sorted.slice(i + 1).find(s => s.trader === snap.trader && s.account === snap.account);
                    const flow = transactions.filter(t => t.trader === snap.trader && t.account === snap.account &&
                        (!prev || parseDate(t.date) > parseDate(prev.date)) && parseDate(t.date) <= parseDate(snap.date)
                    ).reduce((sum, t) => sum + (t.type === 'DEPOSIT' ? t.amount : t.type === 'WITHDRAWAL' ? -t.amount : 0), 0);
                    const pnl = snap.equity - (prev ? prev.equity : 0) - flow;
                    const days = prev ? daysBetween(snap.date, prev.date) : 0;
                    return { ...snap, prevDate: prev?.date || '', flowSinceLast: flow, prevEquity: prev?.equity || 0, pnlPeriod: pnl, daysSincePrev: days, plPerDay: days > 0 ? pnl / days : 0 };
                });
            }, [snapshots, transactions]);

            const dashboardData = useMemo(() => {
                const pairs = new Map();
                snapshotsWithCalcs.forEach(s => {
                    const k = `${s.trader}-${s.account}`;
                    if (!pairs.has(k) || parseDate(s.date) > parseDate(pairs.get(k).date)) pairs.set(k, s);
                });
                let data = Array.from(pairs.values()).map(s => {
                    const txs = transactions.filter(t => t.trader === s.trader && t.account === s.account);
                    const netInv = txs.reduce((sum, t) => sum + (t.type === 'DEPOSIT' ? t.amount : t.type === 'WITHDRAWAL' ? -t.amount : 0), 0);
                    const pl = s.equity - netInv;
                    const plPct = netInv > 0 ? (pl / netInv) * 100 : 0;
                    const firstDate = txs.length ? txs.reduce((e, t) => parseDate(t.date) < parseDate(e.date) ? t : e).date : s.date;
                    const days = daysBetween(new Date().toISOString().split('T')[0].replace(/-/g, '.'), firstDate) + 1;
                    const tSnaps = snapshotsWithCalcs.filter(x => x.trader === s.trader && x.account === s.account).sort((a, b) => parseDate(b.date) - parseDate(a.date));
                    const last3 = tSnaps.slice(0, 3).filter(x => x.plPerDay !== 0);
                    const dds = tSnaps.map(x => x.currentDrawdown || 0).filter(d => d > 0);
                    return {
                        trader: s.trader, account: s.account, latestDate: s.date, equity: s.equity, netInvested: netInv, pl, plPercent: plPct,
                        currentDailyPL3pt: last3.length ? last3.reduce((sum, x) => sum + x.plPerDay, 0) / last3.length : null,
                        currentDailyPL3ptDays: last3.length, dailyPLSinceStart: days > 0 ? pl / days : 0,
                        estDailyPL: weightedAverage(tSnaps), dailyPlPercentSinceStart: days > 0 ? plPct / days : 0, daysSinceStart: days,
                        currentDrawdown: s.currentDrawdown || 0, maxDrawdown: dds.length ? Math.max(...dds) : 0,
                        avgDrawdown: dds.length ? dds.reduce((a, b) => a + b, 0) / dds.length : 0,
                        recoveryFactor: dds.length && Math.max(...dds) > 0 ? plPct / Math.max(...dds) : 0
                    };
                });
                data = accountFilter === 'All' ? data : data.filter(d => d.account === accountFilter);
                Object.keys(filters).forEach(col => {
                    const f = filters[col];
                    if (f?.enabled) {
                        data = data.filter(row => {
                            if (f.type === 'range') {
                                const min = f.min !== '' ? parseFloat(f.min) : -Infinity;
                                const max = f.max !== '' ? parseFloat(f.max) : Infinity;
                                return row[col] >= min && row[col] <= max;
                            }
                            if (f.type === 'text') return row[col].toLowerCase().includes(f.value.toLowerCase());
                            return true;
                        });
                    }
                });
                data.sort((a, b) => {
                    let av = a[sortColumn], bv = b[sortColumn];
                    if (typeof av === 'string') return sortDirection === 'asc' ? av.localeCompare(bv) : bv.localeCompare(av);
                    if (av === null) av = -Infinity;
                    if (bv === null) bv = -Infinity;
                    return sortDirection === 'asc' ? av - bv : bv - av;
                });
                return data;
            }, [snapshotsWithCalcs, transactions, accountFilter, filters, sortColumn, sortDirection]);

            const totals = useMemo(() => ({
                pl: dashboardData.reduce((s, d) => s + d.pl, 0),
                dailyPLSinceStart: dashboardData.reduce((s, d) => s + d.dailyPLSinceStart, 0),
                estDailyPL: dashboardData.reduce((s, d) => s + d.estDailyPL, 0)
            }), [dashboardData]);

            const traderNames = useMemo(() => [...new Set(transactions.map(t => t.trader))].sort(), [transactions]);

            useEffect(() => {
                if (traderNames.length > 0 && selectedTraders.length === 0) {
                    setSelectedTraders(traderNames.slice(0, 5));
                }
            }, [traderNames]);

            const chartColors = ['#3b82f6', '#ef4444', '#10b981', '#f59e0b', '#8b5cf6', '#ec4899', '#06b6d4', '#84cc16', '#f97316', '#6366f1', '#14b8a6', '#a855f7', '#eab308', '#22c55e', '#f43f5e'];

            const timelineData = useMemo(() => {
                if (!selectedTraders.length) return [];
                const filtered = snapshotsWithCalcs.filter(s => 
                    selectedTraders.includes(s.trader) && 
                    (accountFilter === 'All' || s.account === accountFilter)
                );
                const dates = [...new Set(filtered.map(s => s.date))].sort((a, b) => parseDate(a) - parseDate(b));
                return dates.map(date => {
                    const point = { date };
                    selectedTraders.forEach(trader => {
                        const snap = filtered.find(s => s.trader === trader && s.date === date);
                        if (snap) {
                            const txs = transactions.filter(t => t.trader === trader && t.account === snap.account);
                            const netInv = txs.filter(t => parseDate(t.date) <= parseDate(date))
                                .reduce((sum, t) => sum + (t.type === 'DEPOSIT' ? t.amount : t.type === 'WITHDRAWAL' ? -t.amount : 0), 0);
                            const pl = snap.equity - netInv;
                            const plPct = netInv > 0 ? (pl / netInv) * 100 : 0;
                            point[`${trader}_equity`] = snap.equity;
                            point[`${trader}_pl`] = pl;
                            point[`${trader}_plPercent`] = plPct;
                            point[`${trader}_drawdown`] = snap.currentDrawdown || 0;
                        }
                    });
                    return point;
                });
            }, [snapshotsWithCalcs, selectedTraders, accountFilter, transactions]);

            const toggleTrader = (trader) => {
                setSelectedTraders(prev => 
                    prev.includes(trader) ? prev.filter(t => t !== trader) : [...prev, trader]
                );
            };

            const selectAllTraders = () => setSelectedTraders([...traderNames]);
            const clearAllTraders = () => setSelectedTraders([]);

            const handleSort = (col) => {
                if (sortColumn === col) setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');
                else { setSortColumn(col); setSortDirection('asc'); }
            };

            const updateFilter = (col, data) => setFilters(prev => ({ ...prev, [col]: data }));
            const clearFilters = () => setFilters({});
            const saveFilterView = () => {
                if (!filterName.trim()) return alert('Enter filter name');
                setSavedFilters(prev => [...prev, { name: filterName, filters, timestamp: new Date().toISOString() }]);
                setFilterName('');
                alert(`Filter "${filterName}" saved!`);
            };
            const loadFilterView = (v) => setFilters(v.filters);
            const deleteFilterView = (i) => confirm(`Delete "${savedFilters[i].name}"?`) && setSavedFilters(prev => prev.filter((_, idx) => idx !== i));

            const addData = async () => {
                try {
                    const { collection, addDoc } = window.firebaseUtils;
                    const db = window.firebaseDb;
                    if (newData.dataType === 'snapshot' && newData.trader && newData.equity) {
                        await addDoc(collection(db, 'snapshots'), {
                            date: newData.date, trader: newData.trader, account: newData.account,
                            equity: parseFloat(newData.equity), securityKey: window.SECURITY_KEY, timestamp: new Date().toISOString()
                        });
                    } else if (newData.trader && newData.amount) {
                        await addDoc(collection(db, 'transactions'), {
                            date: newData.date, trader: newData.trader, account: newData.account,
                            amount: parseFloat(newData.amount), type: newData.transactionType,
                            note: newData.note, securityKey: window.SECURITY_KEY, timestamp: new Date().toISOString()
                        });
                    }
                    setNewData({ dataType: 'snapshot', date: new Date().toISOString().split('T')[0].replace(/-/g, '.'),
                        trader: '', account: 'Virtual', equity: '', amount: '', transactionType: 'DEPOSIT', note: '' });
                    setShowAddData(false);
                } catch (e) { alert('Failed!'); }
            };

            const getHeatmap = (v, vals) => {
                if (!vals.length) return 'bg-slate-600';
                const valid = vals.filter(x => !isNaN(x) && isFinite(x));
                if (!valid.length) return 'bg-slate-600';
                const min = Math.min(...valid), max = Math.max(...valid);
                if (min === max) return v >= 0 ? 'bg-green-500' : 'bg-red-500';
                const norm = (v - min) / (max - min);
                const cols = ['bg-red-900', 'bg-red-800', 'bg-red-700', 'bg-red-600', 'bg-red-500', 'bg-green-500', 'bg-green-600', 'bg-green-700', 'bg-green-800', 'bg-green-900'];
                return cols[Math.max(0, Math.min(cols.length - 1, Math.floor(norm * (cols.length - 1))))];
            };

            const getDD = (v, vals) => {
                if (!vals.length) return 'bg-slate-600';
                const valid = vals.filter(x => !isNaN(x) && isFinite(x));
                if (!valid.length) return 'bg-slate-600';
                const min = Math.min(...valid), max = Math.max(...valid);
                if (min === max) return v <= 5 ? 'bg-green-500' : 'bg-red-500';
                const norm = 1 - ((v - min) / (max - min));
                const cols = ['bg-red-900', 'bg-red-800', 'bg-red-700', 'bg-red-600', 'bg-red-500', 'bg-green-500', 'bg-green-600', 'bg-green-700', 'bg-green-800', 'bg-green-900'];
                return cols[Math.max(0, Math.min(cols.length - 1, Math.floor(norm * (cols.length - 1))))];
            };

            const getBorder = (d) => d === 3 ? 'border-l-green-500' : d === 2 ? 'border-l-yellow-500' : d === 1 ? 'border-l-orange-500' : '';

            const vals = { pl: dashboardData.map(d => d.pl), plPct: dashboardData.map(d => d.plPercent),
                daily: dashboardData.map(d => d.currentDailyPL3pt).filter(v => v !== null),
                dailyStart: dashboardData.map(d => d.dailyPLSinceStart), est: dashboardData.map(d => d.estDailyPL),
                dailyPct: dashboardData.map(d => d.dailyPlPercentSinceStart), curr: dashboardData.map(d => d.currentDrawdown),
                max: dashboardData.map(d => d.maxDrawdown), avg: dashboardData.map(d => d.avgDrawdown),
                rec: dashboardData.map(d => d.recoveryFactor) };

            const exportXLSX = (type) => {
                const wb = XLSX.utils.book_new();
                if (type === 'all' || type === 'transactions') {
                    XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(transactions.map(t => ({
                        Date: t.date, Trader: t.trader, Account: t.account, Amount: t.amount, Type: t.type, Note: t.note
                    }))), 'Transactions');
                }
                if (type === 'all' || type === 'snapshots') {
                    XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(snapshotsWithCalcs.map(s => ({
                        Date: s.date, Trader: s.trader, Account: s.account, Equity: s.equity, Max: s.runningMaxEquity,
                        DD: s.currentDrawdown, PrevDate: s.prevDate, Flow: s.flowSinceLast, PrevEq: s.prevEquity,
                        PnL: s.pnlPeriod, Days: s.daysSincePrev, PLperDay: s.plPerDay
                    }))), 'Snapshots');
                }
                if (type === 'all' || type === 'dashboard') {
                    XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(dashboardData.map(d => ({
                        Trader: d.trader, Account: d.account, Date: d.latestDate, Equity: d.equity, NetInv: d.netInvested,
                        PL: d.pl, PLPct: d.plPercent, RecFac: d.recoveryFactor, RecentPL: d.currentDailyPL3pt,
                        Days: d.currentDailyPL3ptDays, DailyStart: d.dailyPLSinceStart, Smart: d.estDailyPL,
                        DailyPct: d.dailyPlPercentSinceStart, CurrDD: d.currentDrawdown, MaxDD: d.maxDrawdown, AvgDD: d.avgDrawdown
                    }))), 'Dashboard');
                }
                if (type === 'timeline') {
                    const timelineExport = timelineData.map(point => {
                        const row = { Date: point.date };
                        selectedTraders.forEach(trader => {
                            row[`${trader}_Equity`] = point[`${trader}_equity`];
                            row[`${trader}_PL`] = point[`${trader}_pl`];
                            row[`${trader}_PL%`] = point[`${trader}_plPercent`];
                            row[`${trader}_DD%`] = point[`${trader}_drawdown`];
                        });
                        return row;
                    });
                    XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(timelineExport), 'Timeline');
                }
                XLSX.writeFile(wb, `etoro_${type}_${new Date().toISOString().split('T')[0]}.xlsx`);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-white p-6">
                    <div className="max-w-full mx-auto">
                        <div className="mb-8">
                            <h1 className="text-4xl font-bold mb-2 bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent">
                                eToro Copy Trader Dashboard
                            </h1>
                            <p className="text-slate-400">Firebase Real-time - {transactions.length} txs, {snapshots.length} snaps</p>
                        </div>

                        <div className="flex gap-2 mb-6 flex-wrap">
                            {['dashboard', 'timeline', 'transactions', 'snapshots'].map(tab => (
                                <button key={tab} onClick={() => setActiveTab(tab)}
                                    className={`px-6 py-3 rounded-lg font-semibold ${activeTab === tab ? 'bg-blue-600 shadow-lg' : 'bg-slate-800 hover:bg-slate-700'}`}>
                                    {tab === 'timeline' ? 'Performance Timeline' : tab.charAt(0).toUpperCase() + tab.slice(1)}
                                </button>
                            ))}
                        </div>

                        {activeTab === 'dashboard' && (
                            <div className="space-y-6">
                                <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                                    <div className="bg-slate-800 rounded-xl p-4 border border-slate-700">
                                        <div className="text-slate-400 text-xs mb-1">Total P/L</div>
                                        <div className={`text-2xl font-bold ${totals.pl >= 0 ? 'text-green-400' : 'text-red-400'}`}>
                                            {totals.pl.toFixed(0)} Ft
                                        </div>
                                    </div>
                                    <div className="bg-slate-800 rounded-xl p-4 border border-slate-700">
                                        <div className="text-slate-400 text-xs mb-1">Daily P/L Since Start</div>
                                        <div className={`text-2xl font-bold ${totals.dailyPLSinceStart >= 0 ? 'text-green-400' : 'text-red-400'}`}>
                                            {totals.dailyPLSinceStart.toFixed(0)} Ft
                                        </div>
                                    </div>
                                    <div className="bg-slate-800 rounded-xl p-4 border border-slate-700">
                                        <div className="text-slate-400 text-xs mb-1">Avg Max DD</div>
                                        <div className="text-2xl font-bold text-orange-400">
                                            {dashboardData.length ? (dashboardData.reduce((s, d) => s + d.maxDrawdown, 0) / dashboardData.length).toFixed(2) : '0.00'}%
                                        </div>
                                    </div>
                                    <div className="bg-slate-800 rounded-xl p-4 border border-slate-700">
                                        <div className="text-slate-400 text-xs mb-1">Active Traders</div>
                                        <div className="text-2xl font-bold text-blue-400">{dashboardData.length}</div>
                                    </div>
                                </div>

                                <div className="flex gap-4 items-center bg-slate-800 rounded-xl p-4 border border-slate-700 flex-wrap">
                                    <span>Account:</span>
                                    <select value={accountFilter} onChange={(e) => setAccountFilter(e.target.value)}
                                        className="bg-slate-700 rounded-lg px-4 py-2">
                                        <option>All</option><option>Virtual</option><option>Real</option>
                                    </select>
                                    <button onClick={() => setShowFilters(!showFilters)}
                                        className={`px-4 py-2 rounded-lg font-semibold ${showFilters ? 'bg-blue-600' : 'bg-slate-700'}`}>
                                        {showFilters ? 'Hide' : 'Show'} Filters ({Object.keys(filters).filter(k => filters[k]?.enabled).length})
                                    </button>
                                    {Object.keys(filters).some(k => filters[k]?.enabled) && (
                                        <button onClick={clearFilters} className="bg-orange-600 px-4 py-2 rounded-lg font-semibold">
                                            Clear Filters
                                        </button>
                                    )}
                                    <button onClick={() => exportXLSX('dashboard')} className="ml-auto bg-green-600 px-6 py-2 rounded-lg font-semibold">
                                        Export XLSX
                                    </button>
                                </div>

                                {showFilters && (
                                    <div className="bg-slate-800 rounded-xl p-6 border border-slate-700 space-y-4">
                                        <div className="flex justify-between items-center">
                                            <h3 className="text-lg font-semibold">Filters</h3>
                                            <div className="flex gap-2">
                                                <input type="text" placeholder="View name..." value={filterName}
                                                    onChange={(e) => setFilterName(e.target.value)}
                                                    className="bg-slate-700 rounded-lg px-3 py-1 text-sm" />
                                                <button onClick={saveFilterView} className="bg-blue-600 px-4 py-1 rounded-lg text-sm font-semibold">
                                                    Save
                                                </button>
                                            </div>
                                        </div>
                                        {savedFilters.length > 0 && (
                                            <div>
                                                <div className="text-sm font-semibold mb-2">Saved Views:</div>
                                                <div className="flex flex-wrap gap-2">
                                                    {savedFilters.map((v, i) => (
                                                        <div key={i} className="bg-slate-700 px-3 py-1 rounded-lg flex items-center gap-2">
                                                            <button onClick={() => loadFilterView(v)} className="text-blue-400 text-sm">{v.name}</button>
                                                            <button onClick={() => deleteFilterView(i)} className="text-red-400 text-xs">×</button>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        )}
                                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                            <FilterControl column="equity" label="Equity" type="range" filters={filters} updateFilter={updateFilter} />
                                            <FilterControl column="netInvested" label="Net Invested" type="range" filters={filters} updateFilter={updateFilter} />
                                            <FilterControl column="pl" label="P/L" type="range" filters={filters} updateFilter={updateFilter} />
                                            <FilterControl column="plPercent" label="P/L %" type="range" filters={filters} updateFilter={updateFilter} />
                                            <FilterControl column="recoveryFactor" label="Recovery" type="range" filters={filters} updateFilter={updateFilter} />
                                            <FilterControl column="currentDailyPL3pt" label="Recent Daily" type="range" filters={filters} updateFilter={updateFilter} />
                                            <FilterControl column="dailyPLSinceStart" label="Daily Start" type="range" filters={filters} updateFilter={updateFilter} />
                                            <FilterControl column="estDailyPL" label="Smart Pred" type="range" filters={filters} updateFilter={updateFilter} />
                                            <FilterControl column="dailyPlPercentSinceStart" label="Daily %" type="range" filters={filters} updateFilter={updateFilter} />
                                            <FilterControl column="currentDrawdown" label="Curr DD" type="range" filters={filters} updateFilter={updateFilter} />
                                            <FilterControl column="maxDrawdown" label="Max DD" type="range" filters={filters} updateFilter={updateFilter} />
                                            <FilterControl column="avgDrawdown" label="Avg DD" type="range" filters={filters} updateFilter={updateFilter} />
                                            <FilterControl column="trader" label="Trader" type="text" filters={filters} updateFilter={updateFilter} />
                                            <FilterControl column="account" label="Account" type="text" filters={filters} updateFilter={updateFilter} />
                                        </div>
                                    </div>
                                )}

                                <div className="bg-slate-800 rounded-xl p-6 border border-slate-700 overflow-x-auto">
                                    <table className="w-full text-sm">
                                        <thead>
                                            <tr className="border-b border-slate-700">
                                                <SortableHeader column="trader" label="Trader" sortColumn={sortColumn} sortDirection={sortDirection} handleSort={handleSort} />
                                                <SortableHeader column="account" label="Account" sortColumn={sortColumn} sortDirection={sortDirection} handleSort={handleSort} />
                                                <SortableHeader column="latestDate" label="Date" sortColumn={sortColumn} sortDirection={sortDirection} handleSort={handleSort} />
                                                <SortableHeader column="equity" label="Equity" sortColumn={sortColumn} sortDirection={sortDirection} handleSort={handleSort} align="right" />
                                                <SortableHeader column="netInvested" label="Net Inv" sortColumn={sortColumn} sortDirection={sortDirection} handleSort={handleSort} align="right" />
                                                <SortableHeader column="pl" label="P/L" sortColumn={sortColumn} sortDirection={sortDirection} handleSort={handleSort} align="right" />
                                                <SortableHeader column="plPercent" label="P/L %" sortColumn={sortColumn} sortDirection={sortDirection} handleSort={handleSort} align="right" />
                                                <SortableHeader column="recoveryFactor" label="Recovery" sortColumn={sortColumn} sortDirection={sortDirection} handleSort={handleSort} align="right" />
                                                <SortableHeader column="currentDailyPL3pt" label="Recent Daily" sortColumn={sortColumn} sortDirection={sortDirection} handleSort={handleSort} align="right" />
                                                <SortableHeader column="dailyPLSinceStart" label="Daily Start" sortColumn={sortColumn} sortDirection={sortDirection} handleSort={handleSort} align="right" />
                                                <SortableHeader column="estDailyPL" label="Smart Pred" sortColumn={sortColumn} sortDirection={sortDirection} handleSort={handleSort} align="right" />
                                                <SortableHeader column="dailyPlPercentSinceStart" label="Daily %" sortColumn={sortColumn} sortDirection={sortDirection} handleSort={handleSort} align="right" />
                                                <SortableHeader column="currentDrawdown" label="Curr DD%" sortColumn={sortColumn} sortDirection={sortDirection} handleSort={handleSort} align="right" />
                                                <SortableHeader column="maxDrawdown" label="Max DD%" sortColumn={sortColumn} sortDirection={sortDirection} handleSort={handleSort} align="right" />
                                                <SortableHeader column="avgDrawdown" label="Avg DD%" sortColumn={sortColumn} sortDirection={sortDirection} handleSort={handleSort} align="right" />
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {dashboardData.map(r => (
                                                <tr key={`${r.trader}-${r.account}`} className="border-b border-slate-700/50 hover:bg-slate-700/30">
                                                    <td className="py-3 px-2 font-semibold">{r.trader}</td>
                                                    <td className="py-3 px-2 text-slate-400">{r.account}</td>
                                                    <td className="py-3 px-2 text-slate-400">{r.latestDate}</td>
                                                    <td className="text-right py-3 px-2">{r.equity.toFixed(0)}Ft</td>
                                                    <td className="text-right py-3 px-2">{r.netInvested.toFixed(0)}Ft</td>
                                                    <td className={`text-right py-3 px-2 ${getHeatmap(r.pl, vals.pl)} font-semibold text-white`}>
                                                        {r.pl.toFixed(0)}Ft
                                                    </td>
                                                    <td className={`text-right py-3 px-2 ${getHeatmap(r.plPercent, vals.plPct)} font-semibold text-white`}>
                                                        {r.plPercent.toFixed(2)}%
                                                    </td>
                                                    <td className={`text-right py-3 px-2 ${getHeatmap(r.recoveryFactor, vals.rec)} font-semibold text-white`}>
                                                        {r.recoveryFactor.toFixed(2)}
                                                    </td>
                                                    <td className={`text-right py-3 px-2 border-l-4 ${r.currentDailyPL3pt !== null ? `${getHeatmap(r.currentDailyPL3pt, vals.daily)} ${getBorder(r.currentDailyPL3ptDays)}` : 'bg-slate-700'} text-white`}>
                                                        {r.currentDailyPL3pt !== null ? `${r.currentDailyPL3pt.toFixed(0)}Ft (${r.currentDailyPL3ptDays})` : ''}
                                                    </td>
                                                    <td className={`text-right py-3 px-2 ${getHeatmap(r.dailyPLSinceStart, vals.dailyStart)} text-white`}>
                                                        {r.dailyPLSinceStart.toFixed(0)}Ft
                                                    </td>
                                                    <td className={`text-right py-3 px-2 ${getHeatmap(r.estDailyPL, vals.est)} text-white`}>
                                                        {r.estDailyPL.toFixed(0)}Ft
                                                    </td>
                                                    <td className={`text-right py-3 px-2 ${getHeatmap(r.dailyPlPercentSinceStart, vals.dailyPct)} text-white`}>
                                                        {r.dailyPlPercentSinceStart.toFixed(2)}%
                                                    </td>
                                                    <td className={`text-right py-3 px-2 ${getDD(r.currentDrawdown, vals.curr)} font-semibold text-white`}>
                                                        {r.currentDrawdown.toFixed(2)}%
                                                    </td>
                                                    <td className={`text-right py-3 px-2 ${getDD(r.maxDrawdown, vals.max)} font-semibold text-white`}>
                                                        {r.maxDrawdown.toFixed(2)}%
                                                    </td>
                                                    <td className={`text-right py-3 px-2 ${getDD(r.avgDrawdown, vals.avg)} font-semibold text-white`}>
                                                        {r.avgDrawdown.toFixed(2)}%
                                                    </td>
                                                </tr>
                                            ))}
                                            <tr className="bg-slate-700 font-bold">
                                                <td colSpan="5" className="py-3 px-2">Σ totals</td>
                                                <td className={`text-right py-3 px-2 ${totals.pl >= 0 ? 'bg-green-600' : 'bg-red-600'} text-white`}>
                                                    {totals.pl.toFixed(0)}Ft
                                                </td>
                                                <td colSpan="3"></td>
                                                <td className={`text-right py-3 px-2 ${totals.dailyPLSinceStart >= 0 ? 'bg-green-600' : 'bg-red-600'} text-white`}>
                                                    {totals.dailyPLSinceStart.toFixed(0)}Ft
                                                </td>
                                                <td className={`text-right py-3 px-2 ${totals.estDailyPL >= 0 ? 'bg-green-600' : 'bg-red-600'} text-white`}>
                                                    {totals.estDailyPL.toFixed(0)}Ft
                                                </td>
                                                <td colSpan="4"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}

                        {activeTab === 'timeline' && (
                            <div className="space-y-6">
                                <div className="bg-slate-800 rounded-xl p-4 border border-slate-700">
                                    <div className="flex flex-wrap gap-4 items-center justify-between mb-4">
                                        <div className="flex gap-2 items-center">
                                            <span className="text-slate-300">Account:</span>
                                            <select value={accountFilter} onChange={(e) => setAccountFilter(e.target.value)}
                                                className="bg-slate-700 rounded-lg px-4 py-2">
                                                <option>All</option><option>Virtual</option><option>Real</option>
                                            </select>
                                        </div>
                                        <div className="flex gap-2 items-center">
                                            <span className="text-slate-300">Chart Type:</span>
                                            <select value={chartType} onChange={(e) => setChartType(e.target.value)}
                                                className="bg-slate-700 rounded-lg px-4 py-2">
                                                <option value="equity">Equity Over Time</option>
                                                <option value="pl">P/L Over Time</option>
                                                <option value="plPercent">P/L % Over Time</option>
                                                <option value="drawdown">Drawdown Over Time</option>
                                            </select>
                                        </div>
                                        <button onClick={() => exportXLSX('timeline')} className="bg-green-600 px-6 py-2 rounded-lg font-semibold">
                                            Export Timeline
                                        </button>
                                    </div>
                                    <div className="mb-4">
                                        <div className="flex justify-between items-center mb-3">
                                            <span className="text-slate-300 font-semibold">Select Traders:</span>
                                            <div className="flex gap-2">
                                                <button onClick={selectAllTraders} className="bg-blue-600 px-3 py-1 rounded text-sm">Select All</button>
                                                <button onClick={clearAllTraders} className="bg-slate-700 px-3 py-1 rounded text-sm">Clear</button>
                                            </div>
                                        </div>
                                        <div className="flex flex-wrap gap-2">
                                            {traderNames.map((trader, idx) => (
                                                <button key={trader} onClick={() => toggleTrader(trader)}
                                                    className={`px-4 py-2 rounded-lg font-semibold transition-all ${selectedTraders.includes(trader) ? 'ring-2 ring-white' : 'opacity-50'}`}
                                                    style={{ backgroundColor: chartColors[idx % chartColors.length] }}>
                                                    {trader}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                </div>

                                {selectedTraders.length > 0 && timelineData.length > 0 && (
                                    <div className="bg-slate-800 rounded-xl p-6 border border-slate-700">
                                        <h3 className="text-xl font-semibold mb-4">
                                            {chartType === 'equity' ? 'Equity Over Time' :
                                             chartType === 'pl' ? 'P/L Over Time' :
                                             chartType === 'plPercent' ? 'P/L % Over Time' : 'Drawdown Over Time'}
                                        </h3>
                                        <ResponsiveContainer width="100%" height={400}>
                                            <LineChart data={timelineData}>
                                                <CartesianGrid strokeDasharray="3 3" stroke="#374151" />
                                                <XAxis dataKey="date" stroke="#9ca3af" />
                                                <YAxis stroke="#9ca3af" />
                                                <Tooltip contentStyle={{ backgroundColor: '#1f2937', border: '1px solid #374151' }}
                                                    formatter={(value) => {
                                                        if (chartType === 'equity' || chartType === 'pl') return `${value.toFixed(0)} Ft`;
                                                        if (chartType === 'plPercent' || chartType === 'drawdown') return `${value.toFixed(2)}%`;
                                                        return value;
                                                    }} />
                                                <Legend />
                                                {selectedTraders.map((trader, idx) => (
                                                    <Line key={trader} type="monotone" 
                                                        dataKey={`${trader}_${chartType === 'plPercent' ? 'plPercent' : chartType}`}
                                                        stroke={chartColors[traderNames.indexOf(trader) % chartColors.length]}
                                                        name={trader} strokeWidth={2} dot={false} />
                                                ))}
                                            </LineChart>
                                        </ResponsiveContainer>
                                    </div>
                                )}

                                {selectedTraders.length > 0 && (
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                        {selectedTraders.map((trader, idx) => {
                                            const traderData = dashboardData.find(d => d.trader === trader);
                                            if (!traderData) return null;
                                            return (
                                                <div key={trader} className="bg-slate-800 rounded-xl p-4 border-l-4" 
                                                    style={{ borderLeftColor: chartColors[traderNames.indexOf(trader) % chartColors.length] }}>
                                                    <h4 className="font-bold text-lg mb-3">{trader}</h4>
                                                    <div className="space-y-2 text-sm">
                                                        <div className="flex justify-between">
                                                            <span className="text-slate-400">P/L:</span>
                                                            <span className={traderData.pl >= 0 ? 'text-green-400' : 'text-red-400'}>
                                                                {traderData.pl.toFixed(0)} Ft
                                                            </span>
                                                        </div>
                                                        <div className="flex justify-between">
                                                            <span className="text-slate-400">P/L %:</span>
                                                            <span className={traderData.plPercent >= 0 ? 'text-green-400' : 'text-red-400'}>
                                                                {traderData.plPercent.toFixed(2)}%
                                                            </span>
                                                        </div>
                                                        <div className="flex justify-between">
                                                            <span className="text-slate-400">Max DD:</span>
                                                            <span className="text-orange-400">{traderData.maxDrawdown.toFixed(2)}%</span>
                                                        </div>
                                                        <div className="flex justify-between">
                                                            <span className="text-slate-400">Recovery Factor:</span>
                                                            <span className={traderData.recoveryFactor >= 1 ? 'text-green-400' : 'text-yellow-400'}>
                                                                {traderData.recoveryFactor.toFixed(2)}
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            );
                                        })}
                                    </div>
                                )}

                                {selectedTraders.length === 0 && (
                                    <div className="bg-slate-800 rounded-xl p-12 border border-slate-700 text-center">
                                        <p className="text-slate-400 text-lg">Select traders above to view performance timeline</p>
                                    </div>
                                )}
                            </div>
                        )}

                        {activeTab === 'transactions' && (
                            <div className="space-y-6">
                                <div className="flex gap-4">
                                    <button onClick={() => { setNewData({...newData, dataType: 'transaction'}); setShowAddData(true); }}
                                        className="bg-blue-600 px-6 py-3 rounded-lg font-semibold">Add Data</button>
                                    <button onClick={() => exportXLSX('transactions')} className="bg-green-600 px-6 py-3 rounded-lg font-semibold">Export</button>
                                </div>
                                <div className="bg-slate-800 rounded-xl p-6 border border-slate-700 overflow-x-auto">
                                    <table className="w-full">
                                        <thead>
                                            <tr className="border-b border-slate-700">
                                                <th className="text-left py-3 px-2">Date</th>
                                                <th className="text-left py-3 px-2">Trader</th>
                                                <th className="text-left py-3 px-2">Account</th>
                                                <th className="text-right py-3 px-2">Amount</th>
                                                <th className="text-left py-3 px-2">Type</th>
                                                <th className="text-left py-3 px-2">Note</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {transactions.map(t => (
                                                <tr key={t.id} className="border-b border-slate-700/50 hover:bg-slate-700/30">
                                                    <td className="py-3 px-2">{t.date}</td>
                                                    <td className="py-3 px-2 font-semibold">{t.trader}</td>
                                                    <td className="py-3 px-2 text-slate-400">{t.account}</td>
                                                    <td className="text-right py-3 px-2">{t.amount}Ft</td>
                                                    <td className="py-3 px-2">
                                                        <span className={`px-2 py-1 rounded text-xs font-semibold ${t.type === 'DEPOSIT' ? 'bg-green-600' : 'bg-red-600'}`}>{t.type}</span>
                                                    </td>
                                                    <td className="py-3 px-2 text-slate-400">{t.note}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}

                        {activeTab === 'snapshots' && (
                            <div className="space-y-6">
                                <div className="flex gap-4">
                                    <button onClick={() => { setNewData({...newData, dataType: 'snapshot'}); setShowAddData(true); }}
                                        className="bg-blue-600 px-6 py-3 rounded-lg font-semibold">Add Data</button>
                                    <button onClick={() => exportXLSX('snapshots')} className="bg-green-600 px-6 py-3 rounded-lg font-semibold">Export</button>
                                </div>
                                <div className="bg-slate-800 rounded-xl p-6 border border-slate-700 overflow-x-auto">
                                    <table className="w-full text-sm">
                                        <thead>
                                            <tr className="border-b border-slate-700">
                                                <th className="text-left py-3 px-2">Date</th>
                                                <th className="text-left py-3 px-2">Trader</th>
                                                <th className="text-left py-3 px-2">Account</th>
                                                <th className="text-right py-3 px-2">Equity</th>
                                                <th className="text-right py-3 px-2">Max</th>
                                                <th className="text-right py-3 px-2">DD%</th>
                                                <th className="text-left py-3 px-2">PrevDate</th>
                                                <th className="text-right py-3 px-2">Flow</th>
                                                <th className="text-right py-3 px-2">PrevEq</th>
                                                <th className="text-right py-3 px-2">PnL</th>
                                                <th className="text-right py-3 px-2">Days</th>
                                                <th className="text-right py-3 px-2">PL/day</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {snapshotsWithCalcs.map(s => (
                                                <tr key={s.id} className="border-b border-slate-700/50 hover:bg-slate-700/30">
                                                    <td className="py-3 px-2">{s.date}</td>
                                                    <td className="py-3 px-2 font-semibold">{s.trader}</td>
                                                    <td className="py-3 px-2 text-slate-400">{s.account}</td>
                                                    <td className="text-right py-3 px-2">{s.equity}Ft</td>
                                                    <td className="text-right py-3 px-2 text-blue-400">{s.runningMaxEquity?.toFixed(0)}Ft</td>
                                                    <td className={`text-right py-3 px-2 ${s.currentDrawdown > 0 ? 'text-red-400' : 'text-green-400'}`}>
                                                        {s.currentDrawdown?.toFixed(2)}%
                                                    </td>
                                                    <td className="py-3 px-2 text-slate-400">{s.prevDate}</td>
                                                    <td className="text-right py-3 px-2">{s.flowSinceLast?.toFixed(0)}Ft</td>
                                                    <td className="text-right py-3 px-2">{s.prevEquity}Ft</td>
                                                    <td className={`text-right py-3 px-2 ${s.pnlPeriod >= 0 ? 'text-green-400' : 'text-red-400'}`}>
                                                        {s.pnlPeriod?.toFixed(0)}Ft
                                                    </td>
                                                    <td className="text-right py-3 px-2">{s.daysSincePrev}</td>
                                                    <td className={`text-right py-3 px-2 ${s.plPerDay >= 0 ? 'text-green-400' : 'text-red-400'}`}>
                                                        {s.plPerDay?.toFixed(2)}Ft
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}

                        {showAddData && (
                            <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
                                <div className="bg-slate-800 rounded-xl p-6 max-w-md w-full mx-4 border border-slate-700">
                                    <div className="flex justify-between items-center mb-4">
                                        <h3 className="text-xl font-semibold">Add Data</h3>
                                        <button onClick={() => setShowAddData(false)} className="text-slate-400 hover:text-white text-2xl">×</button>
                                    </div>
                                    <div className="space-y-4">
                                        <div className="flex gap-2">
                                            <button onClick={() => setNewData({...newData, dataType: 'snapshot'})}
                                                className={`flex-1 py-2 rounded-lg font-semibold ${newData.dataType === 'snapshot' ? 'bg-blue-600' : 'bg-slate-700'}`}>
                                                Snapshot
                                            </button>
                                            <button onClick={() => setNewData({...newData, dataType: 'transaction'})}
                                                className={`flex-1 py-2 rounded-lg font-semibold ${newData.dataType === 'transaction' ? 'bg-blue-600' : 'bg-slate-700'}`}>
                                                Transaction
                                            </button>
                                        </div>
                                        <input type="text" placeholder="Date (YYYY.MM.DD)" value={newData.date}
                                            onChange={(e) => setNewData({ ...newData, date: e.target.value })}
                                            className="w-full bg-slate-700 rounded-lg px-4 py-2" />
                                        {newData.dataType === 'snapshot' ? (
                                            <select value={newData.trader} onChange={(e) => setNewData({ ...newData, trader: e.target.value })}
                                                className="w-full bg-slate-700 rounded-lg px-4 py-2">
                                                <option value="">Select Trader</option>
                                                {traderNames.map(n => <option key={n} value={n}>{n}</option>)}
                                            </select>
                                        ) : (
                                            <input type="text" placeholder="Trader" value={newData.trader}
                                                onChange={(e) => setNewData({ ...newData, trader: e.target.value })}
                                                className="w-full bg-slate-700 rounded-lg px-4 py-2" />
                                        )}
                                        <select value={newData.account} onChange={(e) => setNewData({ ...newData, account: e.target.value })}
                                            className="w-full bg-slate-700 rounded-lg px-4 py-2">
                                            <option>Virtual</option>
                                            <option>Real</option>
                                        </select>
                                        {newData.dataType === 'snapshot' ? (
                                            <input type="number" placeholder="Equity" value={newData.equity}
                                                onChange={(e) => setNewData({ ...newData, equity: e.target.value })}
                                                className="w-full bg-slate-700 rounded-lg px-4 py-2" />
                                        ) : (
                                            <>
                                                <input type="number" placeholder="Amount" value={newData.amount}
                                                    onChange={(e) => setNewData({ ...newData, amount: e.target.value })}
                                                    className="w-full bg-slate-700 rounded-lg px-4 py-2" />
                                                <select value={newData.transactionType} onChange={(e) => setNewData({ ...newData, transactionType: e.target.value })}
                                                    className="w-full bg-slate-700 rounded-lg px-4 py-2">
                                                    <option>DEPOSIT</option>
                                                    <option>WITHDRAWAL</option>
                                                    <option>REALLOCATION</option>
                                                </select>
                                                <input type="text" placeholder="Note" value={newData.note}
                                                    onChange={(e) => setNewData({ ...newData, note: e.target.value })}
                                                    className="w-full bg-slate-700 rounded-lg px-4 py-2" />
                                            </>
                                        )}
                                        <button onClick={addData} className="w-full bg-blue-600 px-6 py-2 rounded-lg font-semibold">
                                            Add
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<EtoroTracker />);
    </script>
</body>
</html>
